<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Random interval timer</title>
</head>

<body>
	<h1>XXXX</h1>
	<button onclick="clicked1(this, 'output1');" id="button1">start</button>
	<button onclick="clicked2(this, 'output2');" id="button2">stop</button>
	<span id="output1"></span>
	<span id="output2"></span>
	<script>
		timerId = null;
		function clicked1(button, str) {
			button.disabled = true;
			// button.disabled = false;
			const output = document.getElementById(str);
			let i = 0;
			play();
			output.innerHTML = i;
			timerId = setInterval(() => {
				if (++i < 10) {
					play();
					output.innerHTML = i;
				} else {
					clearInterval(timerId); // 定期実行の終了
					timerId = null;
					button.disabled = false;
				}
			}, 1000); // 1秒おきに実行
		}
		function clicked2(button, str) {
			const output = document.getElementById(str);
			output.innerHTML = "stop1";
			if (timerId) {
				clearInterval(timerId);
				timerId = null;
				const button1 = document.getElementById("button1");
				button1.disabled = false;
			}
			// button.disabled = true;
		}
		</script>
	<h1>音を鳴らす</h1>
	<button onclick="play();">play</button>
	<script>
		function play() {
			const ctx = new AudioContext();
			const oscillator = ctx.createOscillator();
			let current_time = ctx.currentTime;

			// const freqAndTime = [[400, 1], [300, 2]];
			// const freqAndTime = [[2500, 0.1], [0, 0.1], [2500, 0.1]];
			const freqAndTime = [[2500, 0.1]];
			for (const [freq, time] of freqAndTime) {
				oscillator.frequency.setValueAtTime(freq, current_time);
				current_time += time;
			}

			oscillator.connect(ctx.destination);
			oscillator.start(ctx.currentTime);
			oscillator.stop(current_time);
		}
		window.AudioContext = window.AudioContext || window.webkitAudioContext;
	</script>
</body>

</html>
